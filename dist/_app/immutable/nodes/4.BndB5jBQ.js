import{s as oe,e as E,a as P,t as I,c as D,b as q,g as L,d as S,f as d,z as C,i as w,h as b,j as z,A as ne,k as Q,B as ae,C as ie,n as F,D as R,E as se}from"../chunks/scheduler.Cabs2qPT.js";import{S as ce,i as fe,c as T,a as A,m as N,t as k,d as y,f as M,e as V,g as U}from"../chunks/index.CisEW8ZJ.js";import{e as H,d as G,f as ue}from"../chunks/stores.DfX1f76V.js";import{g as J}from"../chunks/entry.CvBM6Ofv.js";import{p as pe}from"../chunks/stores.DJTZAdvF.js";import{U as me,F as K,f as _e,a as de,b as he,c as ge,d as $e}from"../chunks/fa-layers-text.svelte_svelte_type_style_lang.C6VoKrzD.js";import{b as be}from"../chunks/index.Bt-Xh7oU.js";import{L as ve,B as le}from"../chunks/Text.CdW7TBh3.js";import{D as ke}from"../chunks/Divider.97qIrr25.js";function W(i,e,t){const n=i.slice();return n[7]=e[t],n}function X(i,e,t){const n=i.slice();return n[10]=e[t],n}function ye(i){let e,t;return e=new K({props:{icon:_e,size:"1.2x"}}),{c(){T(e.$$.fragment)},l(n){A(e.$$.fragment,n)},m(n,l){N(e,n,l),t=!0},p:F,i(n){t||(k(e.$$.fragment,n),t=!0)},o(n){y(e.$$.fragment,n),t=!1},d(n){V(e,n)}}}function Y(i){let e,t,n;return t=new ve({props:{color:"gray"}}),{c(){e=E("div"),T(t.$$.fragment),this.h()},l(l){e=D(l,"DIV",{class:!0});var o=q(e);A(t.$$.fragment,o),o.forEach(d),this.h()},h(){C(e,"class","loader svelte-10pq0i6")},m(l,o){w(l,e,o),N(t,e,null),n=!0},i(l){n||(k(t.$$.fragment,l),n=!0)},o(l){y(t.$$.fragment,l),n=!1},d(l){l&&d(e),V(t)}}}function we(i){let e,t,n=H(i[7].textItems),l=[];for(let o=0;o<n.length;o+=1)l[o]=Z(X(i,n,o));return{c(){e=E("div");for(let o=0;o<l.length;o+=1)l[o].c();t=P(),this.h()},l(o){e=D(o,"DIV",{class:!0});var r=q(e);for(let a=0;a<l.length;a+=1)l[a].l(r);t=L(r),r.forEach(d),this.h()},h(){C(e,"class","textContainer svelte-10pq0i6")},m(o,r){w(o,e,r);for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(e,null);b(e,t)},p(o,r){if(r&2){n=H(o[7].textItems);let a;for(a=0;a<n.length;a+=1){const f=X(o,n,a);l[a]?l[a].p(f,r):(l[a]=Z(f),l[a].c(),l[a].m(e,t))}for(;a<l.length;a+=1)l[a].d(1);l.length=n.length}},i:F,o:F,d(o){o&&d(e),ne(l,o)}}}function Be(i){let e,t,n,l;return t=new le({props:{ripple:!0,override:{background:"transparent !important",color:i[7].color?i[7].color:"inherit",padding:"5px",margin:"0",height:"100%",width:"100%",justifyContent:"flex-start",textAlign:"left",gap:"10px","&:hover":{background:"transparent"}},$$slots:{default:[Pe]},$$scope:{ctx:i}}}),t.$on("click",function(){se(i[7].on.click)&&i[7].on.click.apply(this,arguments)}),{c(){e=E("div"),T(t.$$.fragment),n=P(),this.h()},l(o){e=D(o,"DIV",{class:!0});var r=q(e);A(t.$$.fragment,r),n=L(r),r.forEach(d),this.h()},h(){C(e,"class","buttonContainer")},m(o,r){w(o,e,r),N(t,e,null),b(e,n),l=!0},p(o,r){i=o;const a={};r&2&&(a.override={background:"transparent !important",color:i[7].color?i[7].color:"inherit",padding:"5px",margin:"0",height:"100%",width:"100%",justifyContent:"flex-start",textAlign:"left",gap:"10px","&:hover":{background:"transparent"}}),r&8194&&(a.$$scope={dirty:r,ctx:i}),t.$set(a)},i(o){l||(k(t.$$.fragment,o),l=!0)},o(o){y(t.$$.fragment,o),l=!1},d(o){o&&d(e),V(t)}}}function Ee(i){let e,t;return e=new ke({props:{color:"grey"}}),{c(){T(e.$$.fragment)},l(n){A(e.$$.fragment,n)},m(n,l){N(e,n,l),t=!0},p:F,i(n){t||(k(e.$$.fragment,n),t=!0)},o(n){y(e.$$.fragment,n),t=!1},d(n){V(e,n)}}}function De(i){let e,t;function n(){return i[4](i[7])}return e=new le({props:{ripple:!0,override:{background:"transparent !important",color:"inherit",padding:"5px",margin:"0",height:"100%",width:"100%",justifyContent:"flex-start",textAlign:"left","&:hover":{background:"transparent"}},$$slots:{default:[Ie]},$$scope:{ctx:i}}}),e.$on("click",n),{c(){T(e.$$.fragment)},l(l){A(e.$$.fragment,l)},m(l,o){N(e,l,o),t=!0},p(l,o){i=l;const r={};o&8194&&(r.$$scope={dirty:o,ctx:i}),e.$set(r)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){V(e,l)}}}function Z(i){let e,t=i[10]+"",n;return{c(){e=E("p"),n=I(t),this.h()},l(l){e=D(l,"P",{class:!0});var o=q(e);n=S(o,t),o.forEach(d),this.h()},h(){C(e,"class","svelte-10pq0i6")},m(l,o){w(l,e,o),b(e,n)},p(l,o){o&2&&t!==(t=l[10]+"")&&z(n,t)},d(l){l&&d(e)}}}function qe(i){let e,t;return e=new K({props:{icon:i[7].icon,size:"1.2x"}}),{c(){T(e.$$.fragment)},l(n){A(e.$$.fragment,n)},m(n,l){N(e,n,l),t=!0},p(n,l){const o={};l&2&&(o.icon=n[7].icon),e.$set(o)},i(n){t||(k(e.$$.fragment,n),t=!0)},o(n){y(e.$$.fragment,n),t=!1},d(n){V(e,n)}}}function Ce(i){let e,t;return e=new K({props:{icon:$e,pulse:!0,size:"1.2x"}}),{c(){T(e.$$.fragment)},l(n){A(e.$$.fragment,n)},m(n,l){N(e,n,l),t=!0},p:F,i(n){t||(k(e.$$.fragment,n),t=!0)},o(n){y(e.$$.fragment,n),t=!1},d(n){V(e,n)}}}function ee(i){let e,t,n=i[7].information+"",l,o;return{c(){e=E("span"),t=I("("),l=I(n),o=I(")"),this.h()},l(r){e=D(r,"SPAN",{class:!0});var a=q(e);t=S(a,"("),l=S(a,n),o=S(a,")"),a.forEach(d),this.h()},h(){C(e,"class","info svelte-10pq0i6")},m(r,a){w(r,e,a),b(e,t),b(e,l),b(e,o)},p(r,a){a&2&&n!==(n=r[7].information+"")&&z(l,n)},d(r){r&&d(e)}}}function Pe(i){let e,t,n,l=i[7].label+"",o,r,a,f;const g=[Ce,qe],c=[];function u(s,$){return s[7].loading?0:1}e=u(i),t=c[e]=g[e](i);let p=i[7].information&&ee(i);return{c(){t.c(),n=P(),o=I(l),r=P(),p&&p.c(),a=R()},l(s){t.l(s),n=L(s),o=S(s,l),r=L(s),p&&p.l(s),a=R()},m(s,$){c[e].m(s,$),w(s,n,$),w(s,o,$),w(s,r,$),p&&p.m(s,$),w(s,a,$),f=!0},p(s,$){let m=e;e=u(s),e===m?c[e].p(s,$):(U(),y(c[m],1,1,()=>{c[m]=null}),M(),t=c[e],t?t.p(s,$):(t=c[e]=g[e](s),t.c()),k(t,1),t.m(n.parentNode,n)),(!f||$&2)&&l!==(l=s[7].label+"")&&z(o,l),s[7].information?p?p.p(s,$):(p=ee(s),p.c(),p.m(a.parentNode,a)):p&&(p.d(1),p=null)},i(s){f||(k(t),f=!0)},o(s){y(t),f=!1},d(s){s&&(d(n),d(o),d(r),d(a)),c[e].d(s),p&&p.d(s)}}}function Ie(i){let e,t,n=i[7].label+"",l,o,r,a=i[7].value+"",f,g;return{c(){e=E("div"),t=E("label"),l=I(n),o=P(),r=E("p"),f=I(a),g=P(),this.h()},l(c){e=D(c,"DIV",{class:!0});var u=q(e);t=D(u,"LABEL",{class:!0});var p=q(t);l=S(p,n),p.forEach(d),o=L(u),r=D(u,"P",{class:!0});var s=q(r);f=S(s,a),s.forEach(d),u.forEach(d),g=L(c),this.h()},h(){C(t,"class","svelte-10pq0i6"),C(r,"class","svelte-10pq0i6"),C(e,"class","inputContainer svelte-10pq0i6")},m(c,u){w(c,e,u),b(e,t),b(t,l),b(e,o),b(e,r),b(r,f),w(c,g,u)},p(c,u){u&2&&n!==(n=c[7].label+"")&&z(l,n),u&2&&a!==(a=c[7].value+"")&&z(f,a)},d(c){c&&(d(e),d(g))}}}function te(i){let e,t,n,l;const o=[De,Ee,Be,we],r=[];function a(f,g){return f[7].type==="input"?0:f[7].type==="divider"?1:f[7].type==="button"?2:f[7].type==="text"?3:-1}return~(e=a(i))&&(t=r[e]=o[e](i)),{c(){t&&t.c(),n=R()},l(f){t&&t.l(f),n=R()},m(f,g){~e&&r[e].m(f,g),w(f,n,g),l=!0},p(f,g){let c=e;e=a(f),e===c?~e&&r[e].p(f,g):(t&&(U(),y(r[c],1,1,()=>{r[c]=null}),M()),~e?(t=r[e],t?t.p(f,g):(t=r[e]=o[e](f),t.c()),k(t,1),t.m(n.parentNode,n)):t=null)},i(f){l||(k(t),l=!0)},o(f){y(t),l=!1},d(f){f&&d(n),~e&&r[e].d(f)}}}function Le(i){var O;let e,t,n,l,o,r,a=((O=i[0])==null?void 0:O.name)+"",f,g,c,u,p;n=new me({props:{$$slots:{default:[ye]},$$scope:{ctx:i}}}),n.$on("click",i[3]);let s=i[1][0].type=="loading"&&Y(),$=H(i[1]),m=[];for(let _=0;_<$.length;_+=1)m[_]=te(W(i,$,_));const re=_=>y(m[_],1,1,()=>{m[_]=null});return{c(){e=E("main"),t=E("div"),T(n.$$.fragment),l=P(),o=E("p"),r=I("Settings for "),f=I(a),g=P(),s&&s.c(),c=P(),u=E("div");for(let _=0;_<m.length;_+=1)m[_].c();this.h()},l(_){e=D(_,"MAIN",{});var h=q(e);t=D(h,"DIV",{class:!0});var B=q(t);A(n.$$.fragment,B),l=L(B),o=D(B,"P",{class:!0});var x=q(o);r=S(x,"Settings for "),f=S(x,a),x.forEach(d),B.forEach(d),g=L(h),s&&s.l(h),c=L(h),u=D(h,"DIV",{class:!0});var v=q(u);for(let j=0;j<m.length;j+=1)m[j].l(v);v.forEach(d),h.forEach(d),this.h()},h(){C(o,"class","svelte-10pq0i6"),C(t,"class","header svelte-10pq0i6"),C(u,"class","settingsContainer svelte-10pq0i6")},m(_,h){w(_,e,h),b(e,t),N(n,t,null),b(t,l),b(t,o),b(o,r),b(o,f),b(e,g),s&&s.m(e,null),b(e,c),b(e,u);for(let B=0;B<m.length;B+=1)m[B]&&m[B].m(u,null);p=!0},p(_,[h]){var x;const B={};if(h&8192&&(B.$$scope={dirty:h,ctx:_}),n.$set(B),(!p||h&1)&&a!==(a=((x=_[0])==null?void 0:x.name)+"")&&z(f,a),_[1][0].type=="loading"?s?h&2&&k(s,1):(s=Y(),s.c(),k(s,1),s.m(e,c)):s&&(U(),y(s,1,1,()=>{s=null}),M()),h&6){$=H(_[1]);let v;for(v=0;v<$.length;v+=1){const j=W(_,$,v);m[v]?(m[v].p(j,h),k(m[v],1)):(m[v]=te(j),m[v].c(),k(m[v],1),m[v].m(u,null))}for(U(),v=$.length;v<m.length;v+=1)re(v);M()}},i(_){if(!p){k(n.$$.fragment,_),k(s);for(let h=0;h<$.length;h+=1)k(m[h]);p=!0}},o(_){y(n.$$.fragment,_),y(s),m=m.filter(Boolean);for(let h=0;h<m.length;h+=1)y(m[h]);p=!1},d(_){_&&d(e),V(n),s&&s.d(),ne(m,_)}}}function Se(i,e,t){let n,l;Q(i,G,c=>t(5,n=c)),Q(i,pe,c=>t(6,l=c));let o,r="loading",a=[{type:"loading"}];ae(async()=>{var c;t(2,o=l.url.searchParams.get("id")),t(0,r=n.list.find(u=>u.id===o)),G.subscribe(u=>{t(0,r=u.list.find(p=>p.id===o))}),await((c=r[r.connectedTo])==null?void 0:c.sync()),t(1,a=[{type:"input",label:"Name",hex:1,value:r.name},{type:"input",label:"Serial Packet Delay",hex:3,options:["1 ms","2 ms","3 ms","4 ms","5 ms","10 ms","15 ms","20 ms","25 ms","30 ms","35 ms","40 ms","45 ms","50 ms","60 ms","70 ms","80 ms","90 ms","100 ms"],value:(r==null?void 0:r.packetDelay)+" ms"},{type:"input",label:"BLE Tx Power Level",hex:4,options:["3 dBm","6 dBm","9 dBm","12 dBm","15 dBm","18 dBm","21 dBm"],value:(r==null?void 0:r.txPower)+" dBm"},{type:"divider"},{type:"button",label:"Reboot device",color:"#f78385",icon:de,on:{click:async()=>{try{t(1,a[4].loading=!0,a),await r[r.connectedTo].reboot(),await r[r.connectedTo].sync(),t(1,a[4].loading=!1,a)}catch(u){alert(u)}}}},{type:"button",label:"Factory reset",color:"#f78385",icon:he,on:{click:async()=>{try{t(1,a[5].loading=!0,a),await ue(r.id),await new Promise(u=>{setTimeout(()=>{u()},500)}),t(1,a[5].loading=!1,a),t(1,a[4].loading=!0,a),await r[r.connectedTo].reboot(),await r[r.connectedTo].sync()}catch(u){alert(u)}}}},{type:"button",label:"Remove device",color:"#f78385",icon:ge,on:{click:()=>{G.update(u=>u.filter(p=>p.id!==o)),J("/")}}},{type:"divider"},{type:"text",textItems:[`Mac: ${r==null?void 0:r.id}`,"Firmware: 1.0.0","Hardware: 1.0.0",`Status: ${r==null?void 0:r.status}`,`Batch: ${(r==null?void 0:r.batch)||1}`]}])}),ie(()=>{t(1,a=[{type:"loading"}])});const f=()=>{history.back()},g=c=>{J(`/device/settings/edit?id=${o}&name=${c.label}&value=${c.value}&hex=${c.hex}${c.options?"&options="+c.options:""}`)};return i.$$.update=()=>{var c;i.$$.dirty&3&&(!r||(r==null?void 0:r.status)!=="connected")&&be&&r!=="loading"&&((c=a==null?void 0:a[4])!=null&&c.loading||J("/"))},[r,a,o,f,g]}class Me extends ce{constructor(e){super(),fe(this,e,Se,Le,oe,{})}}export{Me as component};
